<!--
 * @Copyright: 《高质量c++/c编程指南》
 * @File name: 编程指南.md
 * @Description: 
 * @Author: yangjam
 * @Version: demo
 * @Date: 2020-06-27 09:49:59
 * @History:
   * 2020.6.27--增加编码规范
 * @LastEditTime: 2020-06-28 14:47:23
--> 
<!-- TOC -->

- [文件结构](#文件结构)
  - [版权和版本声明](#版权和版本声明)
  - [头文件结构](#头文件结构)
  - [定义文件的结构](#定义文件的结构)
  - [头文件的作用](#头文件的作用)
  - [目录结构](#目录结构)
- [程序的版式](#程序的版式)
  - [空行](#空行)
  - [代码行](#代码行)
  - [代码行内空格](#代码行内空格)
  - [对齐](#对齐)
  - [长行拆分](#长行拆分)
  - [修饰符的位置](#修饰符的位置)
  - [注释](#注释)
  - [类的版式](#类的版式)
- [命名规则](#命名规则)
  - [共性规则](#共性规则)
  - [简单的windows应用程序命名规则](#简单的windows应用程序命名规则)
  - [## 简单的unix应用程序命名规则](#h2-id简单的unix应用程序命名规则-1873简单的unix应用程序命名规则h2)
- [表达式和基本语句](#表达式和基本语句)
  - [运算符的优先级](#运算符的优先级)
  - [复合表达式](#复合表达式)
  - [if语句](#if语句)
    - [布尔变量与零值比较](#布尔变量与零值比较)
    - [整形变量与零值比较](#整形变量与零值比较)
    - [浮点变量与零值比较](#浮点变量与零值比较)
  - [循环语句的效率](#循环语句的效率)
  - [for语句的循环控制变量](#for语句的循环控制变量)
  - [switch语句](#switch语句)

<!-- /TOC -->

------------
# 文件结构
## 版权和版本声明
* 版权和版本声明位与头文件和定义文件的开头，主要内容有：
  1. 版本信息
  2. 文件名称，标识符，摘要
  3. 当前版本号，作者/修改者，完成日期
  4. 版本历史信息  
    ![avatar](/picture/版权和版本声明.png)
## 头文件结构
* 头文件由三部分内容组成
  1. 开头处的版本和版权声明
  2. 预处理块
  3. 函数和类结构声明
* 规则
  1. 为了防止头文件被重复引用，应使用ifndef/define/endif结构产生预编译块
  2. 用#include < filename.h >来引用标准库的头文件（编译器将从标准库目录开始搜索）
  3. 用#include "filename.h"来引用非标准库的头文件（编译器将从工作目录开始搜索）
  * 建议
    1. 头文件只放“声明”不放“定义”
    2. 不提倡使用全局变量，尽量不要在头文件中出现extern int value这类声明
    ![avatar](/picture/头文件结构.png)
## 定义文件的结构
* 定义文件由三部分内容
  1. 定义文件开头处的版权和版本声明
  2. 对头文件的引用
  3. 程序的实现体(包括数据和代码)
## 头文件的作用
* 通过头文件来调用库功能
* 加强类型安全检查
## 目录结构
* 如果一个软件的头文件数目较多，通常应将头文件和定义文件分别保存于不同的目录

--------------------
# 程序的版式
## 空行
* 规则
  1. 在每个类声明、每个函数定义结束之后都要加空行
  2. 在一个函数体内，逻辑上密切相关的语句之间不加空行，其它地方应加空行分隔
## 代码行
* 规则
  1. 一行代码只做一件事，如只定义一个变量，或只写一条语句
  2. if、for、while、do等语句各自占一行，执行语句不得紧跟其后。无论执行语句有多少都加{}
  * 建议
    1. 尽可能在定义变量的同时初始化该变量
## 代码行内空格
* 规则
  1. 关键字之后要留空格。像if、for、while等关键字之后应留一个空格在接“(”，以突出关键字
  2. 函数名之后不要留空格，紧跟“(”以与关键字区别
  3. “(”向后紧跟，“)”、“,”、“;”向前紧跟，紧跟处不留空格
  4. “,”之后要留空格，如果";"不是一行结束其后要留空格
  5. 赋值运算符、比较操作符、算数操作符、逻辑操作符、位域操作符等二元操作符的前后应当加空格
  6. 一元操作符等前后不加空格
  7. 像“[]”、“.”、“->”等操作符前后不加空格
  * 建议
    1. 对于较长的for和if语句，为了紧凑可以适当去掉部分空格
## 对齐
* 规则
  1. 程序的分节符"{"和"}"应独占一行并且位于同一列，同时与引用他们的语句左对齐
  2. {}之内的代码块在"{"右边数据处左对齐
## 长行拆分
* 规则
  1. 代码行最大长度宜控制在70~80个字符内
  2. 长表达式要在低优先级操作符除拆分成新行，操作符放在新行之首，拆分的新行要进行适当的缩排，使排版整齐
## 修饰符的位置
* 规则
  1. 应当将修饰符 * 和 & 紧靠变量名
## 注释
* 规则
  1. 注释是对代码的“提示”，而不是文档
  2. 代码本来就很清楚，不用加注释
  3. 边写代码遍写注释，修改代码同时修改注释
  4. 注释应当准确、易懂、防止注释的二义性
  5. 尽量避免在注释中使用缩写
  6. 注释的位置应与被描述的代码紧邻，可以放在代码的右方或上方，不可放在下方
  7. 当代码较长，特别是有多重嵌套时，应当在部分段落结束时加注释
   ![avatar](/picture/程序注释.png)
## 类的版式
* 建议使用"以行为中心"的书写方式
    ![avatar](/picture/类的版式.png)

----------------
# 命名规则
## 共性规则
* 规则
  1. 标识符应当直观且可以拼读，可望文知意
  2. 标识符长度应该符合"min-length && max-information"原则
  3. 命名规则尽量与所使用的操作系统或开发工具一致。windows通常使用“大小写”混排的方式，unix通常使用“小写加下划线”的方式
  4. 程序中不要出现仅靠大小写区分的标识符
  5. 程序中不要出现标识符完全相同的局部变量和全局变量
  6. 变量的名字应当使用“名词”或者“形容词+名词”
  7. 全局函数的名字应当使用“动词”或者“动词+名词”，类的成员函数应当只使用“动词”
  8. 用正确的反义词组命名具有互斥意义的变量或相反动作的函数
  * 建议
    1. 尽量避免名字中出现数字编号，除非逻辑上的确需要编号
## 简单的windows应用程序命名规则
* 类名和函数名用大写字母开头的单词组合而成
* 变量和参数用小写字母开头的单词组合而成
* 常量全用大写的字母，用下划线分割单词
* 静态变量前加前缀s_
* 如果不得已需要全局变量，则使用全局变量加前缀g_
* 类的数据成员加前缀m_
* 为了防止某一软件库中的某一些标识和其它软件库中的冲突，可以为各种标识符加上能反映软件性质的前缀
## 简单的unix应用程序命名规则
--------------------------
# 表达式和基本语句
## 运算符的优先级
* 见c/数据结构.md  
  ![](/picture/运算符优先级.png "运算符优先级")
* 规则
  1. 如果代码中的运算符比较多，用括号确定表达式的操作顺序，避免使用默认优先级
## 复合表达式
* 规则
  1. 不要编写太复杂的复合表达式
  2. 不要有多用途的符和表达式
  3. 不要混淆符和表达式与“真正的数学表达式”
## if语句
### 布尔变量与零值比较
* `不可将布尔变量直接与TRUE、FALSE或者1、0进行比较`  
  根据布尔类型的语义，零值为“假”，任何非零值都是“真”。TRUE的值究竟是什么并没有统一的标准。例如Visual C++将TRUE定义为1，而Visual Basic则将TRUE定义为-1。
  ```c
  /* 标准的if语句 */
  if (flag)
  if (!flag)
  ```

### 整形变量与零值比较
* `应当将整形变量用"=="或"!="直接与0比较`
  ```c
  /* 标准语句 */
  if (value == 0)
  if (value != 0)
  ```
### 浮点变量与零值比较
* `不可将浮点变量用"=="或"!="与任何数字比较`  
  无论是float还是double类型的变量，都有精度限制。所以一定要避免将浮点变量用"=="或"!="与数字比较，应该设法转化成">="或"<="形式。
  ```c
  /* 标准语句 */
  if ((x >= -EPSINON) && (x <= EPSINON))
  ```
## 循环语句的效率
* 建议
  1. 在多重循环中，如果有可能，应当将最长的循环放在最内层，最短的循环放在最外层，以减少cpu跨切循环层的次数  
  ```c
  /* 低效率 */
  for (row = 0; row < 100; row++)
  {
    for (col = 0; col < 5; col++)
    {
      sum += a[row][col];
    }
  }
  /* 高效率 */
  for (col = 0; col < 5; col++)
  {
    for (row = 0; row < 100; row++)
    {
      sum += a[row][col];
    }
  }
  ```
  2. 如果循环体内存在逻辑判断，并且循环次数很大，宜将逻辑判断转移到循环体的外面  
  ```c
  for (i = 0; i < n; i++)
  {
    if (condition)
    {
      do_something();
    }
    else
    {
      do_otherthing();
    }
  }
  /*
   * 上面代码比下面代码多执行了n-1次逻辑判断，并且上者老要进行逻辑判断，打断了循环“流水线”作业，使得编译器不能对循环进行优化处理，降低了效率。如果n非常大，最好采用下面的写法，可以提高效率；如果n非常小，两者效率差别不明显，则采用下面写法较好。
   */
  if (condition)
  {
    for (i = 0; i < n; i++)
    {
      do_something();
    }
  }
  else
  {
    for (i = 0; i < n; i++)
    {
      do_otherthing();
    }
  }
  ```
## for语句的循环控制变量
* 不可在for循环体内修改循环变量，防止for循环失去控制
* 建议for语句的循环控制变量的取值采取“半开半闭区间写法”
  ```c
  /* 0 <= x < n, 半开半闭区间*/
  for (int x = 0; x < n; x++)
  {

  }
  /* 0 <= x <= n-1 */
  for (int x = 0; x < n - 1; x++)
  {

  }
  ```
## switch语句
* 每个case语句的结尾不要忘了加break，否则将导致多个分支重叠(除非有意为之)
* 不要忘记最后的default分支
  ```c
  switch (variable)
  {
    case value1:
      break;
    case value2:
      break;
    default:
      break;
  }
  ```
